from typing import Dict
import requests
from bs4 import BeautifulSoup

def get_ecb_exchange_rates() -> Dict[str, float]:
    url = "https://www.ecb.europa.eu/stats/policy_and_exchange_rates/euro_reference_exchange_rates/html/index.en.html"
    
    try:
        response = requests.get(url, timeout=20)
        response.raise_for_status()
    except requests.RequestException as e:
        raise RuntimeError(f"Error fetching data from ECB: {e}")

    soup = BeautifulSoup(response.text, 'html.parser')

    exchange_rates = {}

    # The rates are in a table with id 'ecb-content-col'
    table = soup.find('table', class_='forextable')
    if not table:
        raise RuntimeError("Could not find the exchange rates table on the ECB page.")

    for row in table.find_all('tr')[1:]:  # Skip the header row
        cols = row.find_all('td')
        if len(cols) >= 2:
            currency = cols[0].get_text(strip=True)
            rate_text = cols[1].get_text(strip=True)
            try:
                rate = float(rate_text.replace(',', ''))  # Handle comma as decimal separator
                exchange_rates[currency] = rate
            except ValueError:
                continue  # Skip rows with malformed numbers

    return exchange_rates

# Example usage
if __name__ == "__main__":
    rates = get_ecb_exchange_rates()
    for currency, rate in rates.items():
        print(f"1 EUR = {rate} {currency}")
